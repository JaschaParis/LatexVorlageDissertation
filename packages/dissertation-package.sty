\ProvidesPackage{dissertation-package}[2020/01/01]

%% Allow LaTeX to open more files at the same time than usual. Required for creating glossaries
\RequirePackage{morewrites}
\morewritessetup{allocate=11}

%% Interaction of some packages with the KOMA-Script package
\RequirePackage[setspace=true]{scrhack} 	

%% Fonts
\RequirePackage{packages/dissertation-font-package}


%% Language, font and text
\RequirePackage[ngerman]{babel}          		% Spelling assistance
\RequirePackage{hyphenat} 
\RequirePackage[autostyle]{csquotes} 			% German Quatation Marks


%% Layout of the pages
\addtokomafont{chapter}{\rmfamily\bfseries}
\addtokomafont{section}{\rmfamily\bfseries}
\addtokomafont{subsection}{\rmfamily\bfseries}
\addtokomafont{subsubsection}{\rmfamily\bfseries}
\addtokomafont{paragraph}{\rmfamily\bfseries}
\renewcommand*{\sectfont}{\rmfamily\bfseries}


%% Line spacing, header and footer
\RequirePackage{setspace}									% Line spacing 
\onehalfspacing												% One and a hilf times line spacing, usually desired for dissertations
\RequirePackage[automark, headsepline]{scrlayer-scrpage} 	% Header ans footers
\pagestyle{scrheadings}


%% KOMA Script Options
\KOMAoptions{singlespacing=true}
\KOMAoptions{DIV=last}


%% Tables
\RequirePackage{booktabs}		 				% Appealing horizontal lines
\RequirePackage{multirow}		 				% Allow further division of columns and rows
\RequirePackage{rccol}			 				% Alignment of columns to the decimal point


%% Graphics
\RequirePackage{graphicx} 						% For embedding graphics
\RequirePackage[font=footnotesize]{subcaption} 	% Enabling Subfigures
\RequirePackage{here}
\RequirePackage[hyperref]{xcolor} 				%table, natural


%% Bibliography
%  with indication of the page numbers where the quotation appears
\RequirePackage[backend 		= biber,
				citestyle 		= ZitierstilMaschinenbau,
				bibstyle 		= ZitierstilMaschinenbau, 
				giveninits 		= true, 
				uniquename 		= init,
				isbn 			= true, 
				maxnames 		= 99, 
				minalphanames 	= 3, 
				url 			= false, 
				doi 			= true, 
				block 			= space, 
				sorting			= anyt, 
				sortlocale		= de_DE, 
				backref			= true, 
				backrefstyle	=all+]{biblatex}


% PDF creation 
\PassOptionsToPackage{hyphens}{url} 		% Allow breaks after '-' for URLs
\RequirePackage[]{hyperref}
\hypersetup{pdftex,
		    pdfsubject			= {Dissertation},
		    pdfproducer			= {Latex, Vorlage: J.N. Paris},
		    pdfcreator			= {pdflatex, github.com/JaschaParis/LatexVorlageDissertation},		
		    pdfborder			= {0 0 0},			% Avoid borders in PDF
		    colorlinks			= false,			% Set text color
		    breaklinks 			= true,
		    bookmarksnumbered	= true
}


% Definition of captions
\RequirePackage[format 			= hang,
			    textformat 		= simple, 			% no modifications, period = full stop at the end
			    justification 	= justified,
			    font 			= {footnotesize}, 	% stretch =1.25},
			    labelfont 		= {bf},
			    parskip			= 24pt,
			    hypcap			= true, 			% Jump to the beginning of a float environment at the link
			    aboveskip 		= 6pt 				%,
			    ]{caption}       					% Adjust multiline captions
\captionsetup[subfigure]{labelformat=parens,labelsep=space}


% Embedding of PDF pages
\RequirePackage{pdfpages}


% Definition for breaks regarding URLs
\makeatletter
\g@addto@macro\UrlBreaks{
	\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j
	\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t
	\do\u\do\v\do\w\do\x\do\y\do\z\do\&\do\1\do\2\do\3
	\do\4\do\5\do\6\do\7\do\8\do\9\do\0}
% \def\do@url@hyp{\do\-}
\makeatother
\urlstyle{same}
\Urlmuskip = 0mu plus 0.5mu


% List of abbreviations and and formulas
\RequirePackage[%acronym,			% Abbreviations
				symbols,			% Formula symbols
				nomain,				% No glossary
				nogroupskip,		% Automatic spacing between groups
				%toc,				% Add to table of content (toc)
				%section=chapter,	% Heading level
				nostyles,			%
				translate=babel,	%
				hyperfirst,			%
				indexonlyfirst, 	%
				shortcuts,			%
				xindy={language=german-din}
				]{glossaries}
\RequirePackage{glossary-long}


% References
\RequirePackage[ngerman]{cleveref}


% Floatbarrier for all Sections?
\usepackage[section]{placeins}


% References
\crefname{equation}{}{}
\Crefname{equation}{Gleichung}{Gleichungen}
\crefname{figure}{Abb.}{Abb.}
\Crefname{figure}{Abbildung}{Abbildungen}
\crefname{table}{Tab.}{Tab.}
\Crefname{table}{Tabelle}{Tabellen}
\crefname{chapter}{Kapitel}{Kapitel}
\Crefname{chapter}{Kapitel}{Kapitel}
\crefname{section}{Abschnitt}{Abschnitte}
\Crefname{section}{Abschnitt}{Abschnitte}
\crefname{listing}{Quelltext}{Quelltexte}
\Crefname{listing}{Quelltext}{Quelltexte}
\addto\extrasngerman{\def\figureautorefname{Abb.}} 
\addto\extrasngerman{\def\tableautorefname{Tab.}}
\addto\extrasngerman{\def\equationautorefname{}} 
\addto\extrasngerman{\def\chapterautorefname{Kapitel}} 
\addto\extrasngerman{\def\sectionautorefname{Abschnitt}} 


% Set list and abbreviation names for figures and tables
\renewcaptionname{ngerman}{\listfigurename}{Abbildungen}
\renewcaptionname{ngerman}{\listtablename}{Tabellen}
\renewcaptionname{ngerman}{\figurename}{Abb.}
\renewcaptionname{ngerman}{\tablename}{Tab.}


% Custom functions
\newcommand{\centercell}[1]{\multicolumn{1}{c}{#1}}


% Custom macros
\DeclareRobustCommand{\glscaption}[1]{\glsentrytext{#1}}
\newcommand{\bigcell}[2]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}

% Todo Content macro
\newcommand{\todocontent}[1]{
	\vspace{2mm} 
	\textbf{\textcolor{RWTHrot}{TODO:}}
	\textcolor{RWTHblau}{#1} 
	\vspace{2mm}
	\\}

% Inlcude figure macro
\newcommand{\includeFig}[2]{%
	\ifdefined\INCLUDETIKZ%
	\input{#2}%
	\else% 
	\ifdefined\INCLUDEJPG%
	\includegraphics{#1.jpg}%
	\else%
	\includegraphics{#1.pdf}%
	\fi%
	\fi%
}

% Environments
\newenvironment{herefigure}				%
{\noindent\begin{minipage}{\linewidth}	% to keep image and caption on one page
		\captionsetup{type=figure}		% set links to beginning of environment (hypcap)
	}%
	{%
	\end{minipage}%
}

\newenvironment{heretable}				%
{\noindent\begin{minipage}{\linewidth}	% to keep image and caption on one page
		\captionsetup{type=table}		% set links to beginning of environment (hypcap)
	}%
	{%
	\end{minipage}%
}

% Layout of the pages

% Adjust spacing before and after headings
\renewcommand*{\chapterheadstartvskip}{\vspace*{\baselineskip}}
\renewcommand*{\chapterheadendvskip}{\vspace{\baselineskip}}

\RedeclareSectionCommand[%
tocnumwidth=2.5em,						% more space for numbering of part entries
]{part}

\RedeclareSectionCommand[%
tocnumwidth=2.5em,						% more space for numbering of chapter entries
]{chapter}

\RedeclareSectionCommand[%
tocnumwidth=2.5em, 						% more space for numbering of section entries
tocindent=2.5em,						% more space for numbering of section entries
]{section}

\RedeclareSectionCommand[%
tocindent=5.1em,						% more space for numbering of section entries
]{subsection}

\makeatletter
\renewcommand*{\@pnumwidth}{1.75em}
%\renewcommand*{\@tocrmarg}{1.85em}
\makeatother

\endinput
